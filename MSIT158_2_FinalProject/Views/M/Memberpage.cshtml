<form id="upimg" style="margin:10px">
    <img src="~/img/cccccc.jpg" id="im1" style="width: 200px;height: 200px;object-fit: contain;" />
    <div class="mb-3">
        <input class="form-control" type="file" id="formFile" accept="image/*" onchange="ch1()" name="IMG" style="width:19.6rem;margin-top:10px;">
    </div>
</form>


<ul class="nav nav-tabs" style="font-size:20px">
    <li class="nav-item">
        <a class="nav-link active" aria-current="page" href="#">全部訂單</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" style="color:black">未結帳訂單</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" style="color:black">已完成訂單</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#" style="color:black">已取消訂單</a>
    </li>
</ul>
<table class="table table-hover" style="font-size:20px">
    <thead>
        <tr>
            <th scope="col">照片預覽</th>
            <th scope="col">商品名</th>
            <th scope="col">件數</th>
            <th scope="col">總價</th>
            <th scope="col">日期</th>
            <th scope="col">詳細/評價</th>
        </tr>
    </thead>
    <tbody style="font-size=32px">
        @foreach (var v in ViewBag.訂單預覽)
        {
            <tr>
                <td>
                    @if (v.圖片 != null)
                    {
                        <img src="data:image/jpeg;base64,@System.Convert.ToBase64String(v.圖片) " style="width: 70px;height: 70px;object-fit: contain;" alt="">
                    }
                    else
                    {
                        <img src="~/assets/Img/packageImages/@v.圖片2" style="width: 70px;height: 70px;object-fit: contain;" alt="">
                    }
                </td>
                <td style="vertical-align: middle;">@v.name</td>
                <td style="vertical-align: middle;">@v.總數.ToString("0")</td>
                <td style="vertical-align: middle;">@v.總價.ToString("0")</td>
                <td style="vertical-align: middle;">@v.OrderDate.ToString("yyyy/MM/dd HH:mm")</td>
                <td style="vertical-align: middle;">
                    <button type="button" class="btn btn-danger" style="vertical-align: middle;">詳細</button>
                </td>
            </tr>

                @* <tr>
                <td colspan=5>
                    <div class="progress" role="progressbar" aria-label="Warning example" aria-valuenow="75" aria-valuemin="0" aria-valuemax="100">
                        <div class="progress-bar text-bg-warning" style="width: 75%">75%</div>
                    </div>
                    </td>
                </tr> *@
        }
    </tbody>
</table>
<script>
    async function ch1() {
        var d;
        if (formFile.files[0].type.match("image.*")) {
            await UP()
            var rd = new FileReader();
            rd.onload = function (e) {
                d = this.result;
                var blob = new Blob([d], { type: "image/jpg" })
                var uri = window.URL || window.webkitURL;
                im1.src = uri.createObjectURL(blob)
            };
            rd.readAsArrayBuffer(formFile.files[0]);
        }
        else
            alert("請選擇圖片")
    }
    async function UP() {
        var c = new FormData(upimg);
        var a = await fetch(`@Url.Content("~/M/upMemberimgAPI")`, { method: "POST", body: c })
        var b = await a.text()
    }
</script>