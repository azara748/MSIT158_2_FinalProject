
@{
    ViewData["Title"] = "AllPackagesPage";
    Layout = "_Layout_Backstage";
}

<h1>AllPackagesPage</h1>
<select id="selector" class="form-select" style="width:10em; margin-bottom:1em">
    <option></option>
</select>

<section>
    <table class="table">
        <thead>
            <tr>
            </tr>
        </thead>

        <tbody id="table">
        </tbody>
    </table>
</section>

@section Scripts{
    <script>
        const table = document.querySelector("#table");
        const selector = document.querySelector("#selector");
        (async () => {
            const response = await fetch('@Url.Content("~/package/AllPackages")')
            if (!response.ok) {
                console.log(`erroe message:${response.status}`)
                return
            }
            const datas = await response.json()
            console.log(datas);
            const package = datas.map(p => {
                return `
                        <tr>
                        <td>${p.packName}</td>
                        <td><img src="${'@Url.Content("~/assets/img/packageimages/")' + p.picture}" alt="${p.packName}" width="100" height="100" /></td>
                        <td>${p.price}</td>
                    </tr>
                `
            });
            table.innerHTML = package.join("");

            const pCategoryRes = await fetch('@Url.Content("~/package/PackageCategory")')
            if (!pCategoryRes.ok) {
                console.log(`erroe message:${response.status}`)
                return
            }
            const pCategoryDatas = await pCategoryRes.json()
            console.log("styles:" + pCategoryDatas);
            const seletorPackage = pCategoryDatas.map(c => `<option value="${c}">${c}</option>`)
            selector.innerHTML = seletorPackage.join("");

        })()


    </script>
}




@section Styles {
    <style>

    </style>
}